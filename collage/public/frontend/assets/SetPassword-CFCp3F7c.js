var g=(P,p,t)=>new Promise((m,d)=>{var n=e=>{try{r(t.next(e))}catch(l){d(l)}},i=e=>{try{r(t.throw(e))}catch(l){d(l)}},r=e=>e.done?m(e.value):Promise.resolve(e.value).then(n,i);r((t=t.apply(P,p)).next())});import{_ as b,m as S,r as u,k as N,b as v,o as w,d as o,i as V,n as y,p as _,v as f,t as h}from"./index-BmA6OMtU.js";const x={class:"reset-password"},C={class:"card"},M={key:0},T={key:1,class:"error"},U={key:2,class:"success"},j=["disabled"],B={__name:"SetPassword",setup(P){const p=S(),t=u(p.query.key||""),m=u(p.query.user||""),d=u(""),n=u(""),i=u(""),r=u(!1),e=u(""),l=u("");N(()=>p.query,a=>{t.value=a.key||"",m.value=a.user||""},{immediate:!0});const k=()=>g(this,null,function*(){if(e.value="",l.value="",!n.value){e.value="Please enter a new password.";return}if(n.value!==i.value){e.value="Passwords do not match.";return}r.value=!0;try{const a=yield fetch("/api/method/frappe.core.doctype.user.user.update_password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:t.value||"",old_password:d.value,new_password:n.value,confirm_password:i.value,logout_all_sessions:1})});if(a.status===200){const s=yield a.json();l.value="Password updated successfully!",console.log("Response:",s),setTimeout(()=>{router.push("/my-profile")},2e3)}else{const s=yield a.json();e.value=s.message||"Something went wrong."}}catch(a){e.value=a.message||"Network error."}finally{r.value=!1}});return(a,s)=>(w(),v("section",x,[o("div",C,[s[3]||(s[3]=o("h2",null,"Reset Password",-1)),o("form",{onSubmit:V(k,["prevent"])},[t.value?y("",!0):(w(),v("div",M,[_(o("input",{"onUpdate:modelValue":s[0]||(s[0]=c=>d.value=c),type:"password",placeholder:"Old Password",autocomplete:"current-password"},null,512),[[f,d.value]])])),o("div",null,[_(o("input",{"onUpdate:modelValue":s[1]||(s[1]=c=>n.value=c),type:"password",placeholder:"New Password",autocomplete:"new-password"},null,512),[[f,n.value]])]),o("div",null,[_(o("input",{"onUpdate:modelValue":s[2]||(s[2]=c=>i.value=c),type:"password",placeholder:"Confirm Password",autocomplete:"new-password"},null,512),[[f,i.value]])]),e.value?(w(),v("p",T,h(e.value),1)):y("",!0),l.value?(w(),v("p",U,h(l.value),1)):y("",!0),o("button",{type:"submit",disabled:r.value},h(r.value?"Updating...":"Confirm"),9,j)],32)])]))}},q=b(B,[["__scopeId","data-v-b09b2edd"]]);export{q as default};
//# sourceMappingURL=SetPassword-CFCp3F7c.js.map
